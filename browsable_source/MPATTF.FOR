      SUBROUTINE MPATTF
C
      IMPLICIT INTEGER(A-Z)
C
C
      INTEGER*2
     * FTYPE,DUE,
     *NREDMO,PILA
     *RRADIX,CXT,KEY,RADIX,KEYM,KEY1,KEY2,TRE,R1,REDEFT,
     * UNO,DUMMY,KEYTEM,NENTPO,CXTT,SNUM,NAPPID,ACXT,
     * AAK,LIB,LIST,R,S,CXTX,PADRE,FIRSTS,FIRSTB
C
      LOGICAL FLAG
C
      COMMON /I1/t10 /LIFE/LIFE (128)
      COMMON /VALUE/ FWQ(4) ,VALUE(1023)
      COMMON / KGBC / KGBC
      COMMON /LISTA/PILA (256) /NREDMO/NREDMO
      COMMON /CONTAP/CONTAP /LASTAP/LASTAP /SCTSON/SCTSON /LISTSC/LISTSC
     */SCTHEA/SCTHEA /LISPXA/LISPXA /ERRORA/ERRORA
      COMMON /REDEFT/REDEFT
      LOGICAL LOOKA P
      COMMON
     */ UNIT / UNIT
C
      COMMON
     */ ABLOCK / V1(3),ABLOCK(1284)
     */ BBLOCK / V2(3),BBLOCK(3072)
     */ CBLOCK / V3(3),CBLOCK(4096)
     */ FLA / FLA
     */ FLB / FLB
     */ FLC / FLC
     */ NAPPOI / NAPPOI
     */ BPOINT / BPOINT
     */ CPOINT / CPOINT
     */ SNUM / SNUM
C
      COMMON
     */ CPLIST / BBC(3) ,CPLIST ( 128)
     */ CAR / B1(4) ,CAR(15767)
     */ CDR / B2(4) ,CDR(15767)
     */ ALMODE / ALMODE
     */ NENTPO / NENTPO
C
      COMMON
     */ R / C1(3) ,R(128)
     */ S / C2(3) ,S(128)
     */ PADRE / C3(3),PADRE(128)
     */ FIRSTS / C4(3),FIRSTS(128)
     */ FIRSTB / C5(3),FIRSTB(128)
     */ LIST / C6(3),LIST(128)
     */ LIB / LIB
     */ CXTX / B1(3),CXTX(128)
     */ CXT / BB1(3),CXT(256)
     */ KEY / BB2(3),KEY(256)    
C
      COMMON
     */ NIL / NIL
     */ BASE / BASE
     */ NEVALV / NEVALV
     */ UNNO / UNNO
     */ NTYPEE / NTYPEE
     */ ACXT / ACXT
     */ AAK / AAK
     */ RADIX / RADIX
     */ RRADIX/ RRADIX
     */ PPDEM / PPDEM
     */ CXTM / CXTM
     */ CXTT / CXTT
     */ NAPPID / NAPPID
     */ T / T
C
C
       DIMENSION
     *FUN(1284),RETP (1284),CP(1284),BLP(1284),SEGNO(1284),ABP(1284),
     *BIND(3072),VAR(3072),BBP(3072),SONBRO(4096),NREENT (4096),
     *VALORE(4096),INF(4096),LISTAR(4096),BLINK(4096)
C
C
       EQUIVALENCE
     *(ABLOCK(1),FUN(1)).
     *(ABLOCK(2),RETP(1)),
     *(ABLOCK(3),CP(1)),
     *(ABLOCK(4),BLP(1)),
     *(ABLOCK(5),SEGNO(1)),
     *(ABLOCK(6),ABP(1)),
     *(BBLOCK(1),BIND(1)),
     *(BBLOCK(2),VAR(1)),
     *(BBLOCK(3),BBP(1)),
     *(CBLOCK(1),SONBRO(1)),
     *(CBLOCK(2),NREENT(1)),
     *(CBLOCK(3),VALORE(1)),
     *(CBLOCK(3),INP(1)),
     *(CBLOCK(4),LISTAR(1)),
     *(CBLOCK(4),BLINK(1))
C
      DATA KEYM/-1/,UNO/1/,TRE/3/,DUE/2/
C
      CALL GETARG
      INDIC = NENTPO-71
      GO TO
     *(72,73,74,75,3,3,78,79,80),INDIC
3     WRITE(6,1004) NENTPO
1004  FORMAT (' MPATTE,NENTPO ERRATO',I10)
      CALL HLT
C     DELOCAZIONE E RITORNO.
76831 IF (ALMODE .NE. 0) GO TO 1
      CALL CPOP
      SONBRO(CPOINT) = MOD(SONBRO(CPOINT),UNNO)
      GO TO 2
1     CPOINT = BLINK (CPOINT)
2     RETURN
11121 CALL ERROF(21)
11122 CALL ERROP(22)
11124 CALL ERROF(24)
11125 CALL ERROF(25)
11136 CALL ERROF(36)
C
C***********    SCT PN    ***********************************
72    RFLAG = 0
      GOTO 9182
      ENTRY SCTPN
      RFLAG = 1
9182  CONTINUE
      UNIT=6
      MTEMP=LISTSC
2000  MASK=9*NTYPEE+BASE
      IF (MTEMP.EQ.0) GOTO 2001
      WRITE(UNIT,2002) MTEMP,BLINK(MTEMP)
2002  FORMAT ('0',2I6)
      TEMP=INF(MTEM P)
      IF(FTYPE(TEMP).NE.REDEFT) GOTO 2003
2004  IF(TEMP.EQ.NIL) GOTO 2005
      CAR(CAR(TEMP))=CAR(CAR(TEMP)) +MASK
      CDR(CAR(TEMP))=CDR(CAR(TEMP)) +MASK
      TEMP=CDR(TEMP)
      GOTO 2004
2005  IF(MASK.LT.O) GOTO 2006
      MASK=-MASK
      TEMP=INF(MTEMP)-31*NTYPEE
      CALL PRINTS(TEMP,UNO)
      CALL OUTBUF
      GOTO 2004
2003  WRITE(UNIT,2007) RRADIX,INF(MTEMP)
2007  FORMAT(' (',I5,'. ',I5,')')
2006  WRITE(UNIT,2007) CAR(NREENT(MTEMP)),CDR(NREENT(HTEMP))
      MTEMP=SONBRO(MTEMP)
      GOTO 2000
2001  CONTINUE
           IF (RFLAG.EQ.0) GOTO 76833
      RETURN
76833 NEVALV=NIL
      GOTO 76831
C
C     ENTLAB(73) /*GETCXT */
C
73    ARG2 = ARGF(2)
      IF(ARG2.NE.NIL) GOTO 95
      CALL RINCA(ACXT,UNO,KEYTEM)
      IF(KEYTEM.LT.0) GOTO 11122
      ARG2 = ACXT
      GO TO 96
95    IF(FTYPE(ARG2).NE.CXTT)    GOTO 11121
      KEYTEM = ARG2
      CALL RINCA(KEYTEM,UNO,KEY1)