      SUBROUTINE BASEFF
C
      IMPLICIT INTEGER(A-Z)
C
C
      INTEGER*2
     *A TOMT,NLAMBD,NAPPID,LISTT,INDMAX,NENTPO,AAK,IPUN,NNAMBD,
     * GENKEY,CXTX,RRADIX,ACXT,
     *CXTC,NREDMO,DUMMY,UNO,DUE,KRYFOU,CXTNEW,NEWKEY,CXTT
      DOUBLE PRECISION NPRINA,PRINO
C
      COMMON /LASTAP/LASTAP /CONTAP/CONTAP /LISTSC/LISTSC/SCTSON/SCTSON
      COMMON /NUMCXT/ NUMCXT
      COMMON /SCTHEA/ SCTHEA
      COMMON / UNIT / UNIT
C
      COMMON
     */ ABLOCK / V1(3),ABLOCK(1284)
     */ BBLOCK / V2(3),BBLOCK(3072)
     */ CBLOCK / V3(3),CBLOCK(4096)
     */ FLA / FLA
     */ FLB / FLB
     */ FLC / FLC
     */ NAPPOI / NAPPOI
     */ BPOINT / BPOINT
     */ CPOINT / CPOINT
C
      COMMON / SWIRET / SWIRET
C
      COMMON
     */ VALUE / A1(4),VALUE(1023)
     */ FDEF / A2(4),FDEF(1023)
     */ PLIST / A3(4),PLIST(1023)
     */ NPRINA / A4(4),PRINO,NPRINA(1023)
C
      COMMON
     */ CAR / B1(4),CAR(15767)
     */ CDR / B2(4),CDR(15767)
     */ FLFS / FLFS
     */ FSSIZE / FSSIZE
C
      COMMON
     */ ALMODE / ALMODE
     */ ARG1 / ARG1 NOBIND / NOBIND
     */ NEVALV / NEVALV
     */ NIL / NIL NTYPEE / NTYPEE
     */ UNNO / UNNO
     */ T / T
C
      COMMON
     */ ATONT / ATOMT
     */ NLAMBD / NLAMBD
     */ NNAMBD/NNAMBD
     */ NAPPID / NAPPID
     */EXES/EXES
     */ LISTT / LISTE
     */ INDMAX / INDMAX
     */ NENTPO / NENTPO
     */ AAK / AAK
     */ CXTX / BB1(3),CXTX(128)
     */ CPLIST / BAB(3),CPLIST( 128)
     */ CXTC / CXTC
     */ ACXT/ ACXT
     */ CXTT / CXTT
     */ NREDMO / NREDMO
     */ RRADIX / RRADIX
CSTAT
CSTAT
      COMMON /CONCON/ CONCON
C
C
      DIMENSION
     *FUN(1284),RETP(1284),CP(1284),BLP(1284),SEGNO(1284),ABP(1284),
     *BIND(3072),VAR(3072),BBP(3072),SONBRO(4096),NREENT(4096),
     *VALORE(4096),INF(4096),LISTAR(4096),BLINK(4096)
C
      EQUIVALENCE
     *(ABLOCK(1),FUN(1)),
     *(ABLOCK(2),RETP(1)),
     *(ABLOCK(3),CP(1)),
     *(ABLOCK(4),BLP(1)),
     *(ABLOCK(5),SEGNO(1)),
     *( ABLOCK(6),ABP( 1)),
     *(BBLOCK(1),BIND(1)),
     *(BBLOCK(2),VAR(1)),
     *(BBLOCK(3),BBP(1)),
     *(CBLOCK(1),SONBRO(1)),
     *(CBLOCK(2),NREENT(1)),
     *(CBLOCK(3),VALORE(1)),
     *(CBLOCK(3),INF(1)),
     *(CBLOCK(4),LISTAR(1)),
     *(CBLOCK(4),BLINK( 1))
C
      DATA UNO/1/,DUE/2/
C     *********  COMMENTO  ***********
C    SI SUPPONE CHE LE FUNZIONI DI BASE NON ALTERINO "ALMODE"
C  ***********************************************************
      CALL GETARG
999  INDIC = NENTPO-19
      GO TO
     *(20,21,22,23,23,23,26,27,28,23,30,
     *23,23,23,34,35,36,37,38,23),INDIC
23    WRITE(6,1100) NENTPO
1100  FORMAT(' BASEFF,NENTPO ERRATO',I10)
      CALL HLT
C DELOCAZIONE E RITORNO
C
76801 CONTINUE
998    IF(ALMODE.NE.0) GO TO 1
      CALL CPOP
      SONBRO(CPOINT) = MOD(SONBRO(CPOINT) .UNNO)
      GO TO 2
      CPOINT = BLINK(CPOINT)
2     SWIRET=2
997   RETURN
C
C     ENTLAB(20) INDIC= 1  * CAR *
C
20    ARG1 = ARGF(1)
      TEMP = FTYPE(ARG1)
      IF(TEMP.NE.LISTT) CALL ERROF(41)
      NEVALV = CAR(ARG1)
      GOTO 76801
C3     IF(TEMP.NE.ATOMT) CALL ERROF(19)
C      NEVALV = ALRVLR(VALUE(ARG1) )
C      IF(NEVALV.NE.NOBIND) GO TO 76801
C      CALL ERROF(19)
C      GOTO 76801
C
C     ENTLAB(21) INDIC = 2    *CDR*
C
21    ARG1 = ARGF(1)
      TEMP = FTYPE(ARG1)
      IF(TEMP.NE.LISTT) CALL ERROF(41)
      NEVALV = CDR(ARG1)
      GOTO 76801
C5     IF(TEMP.NE.ATOMT) CALL ERROF(19)
C      NEVALV = PLIST(ARG 1)
C       WRITE(6,4432)
C4432    FORMAT(' CDR OF ATOM')
C      GOTO 76801
C     PRODUCE UNA LISTA CHE PUO CONTENERE I RIDEFINEIT
C    
C     ENTLAB(22) INDIC = 3  * CONS *
C
22    NEVALV = CONSF(ARGF(1),ARGF(2))
      GOTO 76801
C
C     ENTLAB(26) INDIC = 7 * ATOMP *
C
26    NEVALV = T
      IF(ARGF(1)/NTYPEE.EQ.LISTT) NEVALV=NIL
      GOTO 76801
C
C     ENTLAB(27) INDIC = 8  * EO *
C
27    NEVALV = NIL
      IF(ARGF(1).EQ.ARGF(2) ) NEVALV = T
      GOTO 76801
C
C     ENTLAB(30) INDIC = 11  * SET *
C
30    ARG1 = ARGF(1)
