GO TO 678
ENTLAB (80) CONTRACT
C
80
ARG1 = ARGF (1)
ARG2 = ARGF (2)
IF (ARG1.EQ. NIL. OR . FTYPE (ARG 1) .NE. CXTT)
GOTO 11121
IF (ARG2 .EQ.NIL) GO TO 1200
IF (FTYPE (ARG2) . NE .CXTT)
GOTO 11121
C
J = 2 CONTRACT CON DUE ARGOMENTI
C
J = 2
DUMMY = ARG1
KEYTEM = ARG2
CALL RINCA (DUMMY, UNO, KEY1)
IF (KEY1 .LT.O) GOTO 11122
CALL RINCA (KEYTEM, UNO, KEY2)
IF (KEY2.LT.0) GOTO 11122
CONTRACT (X Y)
VERIFICA DELLA DISCENDENZA DI KEY2 DA KEY1
IF (R (KEY1) .GT .R (KEY2) .OR. S (KEY1) .LT.S (KEY2) )
GOTO 11124
SI CONTROLLA SE AAK (CHIAVE ATTUALE) E' UN SUCCESSORE DI KEY2
SE VERO: PUO' ESSERE ESEGUITA LA CONTRACT (X Y)
SE FALSO: SI CONTROLLA CHE AAK NON FACCIA PARTE DEL
SOTTOALBERO CON RADICE IN KEY1 O SIA UGUALE A KEY1 STESSA.
IF (R (AAK) .GE. R (KEY2) .AND. S (AAK) . LE. S (KEY2) ) GOTO 300
IF (R (AAK) . GE .R (KEY1) .AND.S (AAK) .LE.S (KEY 1) )
GOTO 11125
GO TO 300
C
J = 1
CONTRACT CON UN SOLO ARGOMENTO
C
1200
DUMMY = ARG 1
CALL RINCA (DUMMY, UNO, KEY1)
IF (KEY1.LT.0) GOTO 11122
C
C
CONTRACT (X)
SI CONTROLLA CHE AAK NON FACCIA PARTE DEL SOTTOALBERO CON RADICE
IN KEY1 ,O SIA UGUALE A KEY1 STESSA.
C
IF (R ( AAK) .GE. R (KEY1) . AND. S (AAK) . LE. S (KEY1) )
GOTO 11125
J = 1
O.K. TEST SULLA DISCENDENZA
O .K. TEST SULLA VITA FUTURA DELLA CHIAVE ATTUALE
C
300
GO TO (8008,8010) , J
C
SI VERIFICA CHE LA RADICE DEL SOTTOALBERO DA CONTRATTARE
C
NON SIA UGUALE ALLA RADICE VIRTUALE.
C
8010
IF (RRADIX .NE.
KEY1
GO TO 8008
