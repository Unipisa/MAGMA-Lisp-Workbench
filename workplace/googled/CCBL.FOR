C
RACCOLTA ELEMENTI C-BLOCK
SUBROUTINE CCBL
IMPLICIT INTEGER (A-2)
COMMON
*/CB LOCK/V3 (3),CBLOCK (4096)
*/FLC/FLC */CSIZE/ CSIZE
*/KONTC/KO NTC
*/KGBC/KGBC */NIL/NIL
DIMENSION
*INF (4096), BLINK (4096),SON BRO (4096), NREENT (4096)
EQUIVALENCE *(CBLOCK (3), INF (1)), (CBLOCK (4), BLINK (1)),
*(CBLOCK (1), SONBRO (1)), (CBLOCK (2),NREENT (1))
DATA M2/Z7F FF FF FF/
KONTC=0 I-CSIZE-3
IF(INF (I) LT.0) GO TO 10 BLINK (1) NIL
FLC-I
9
NREENT (I) =M2 KONTC KON TC+1
GO TO 2
10
INF (I)=IA ND (INF (I), M2)
I=1-4
IF(I.GE.0) GO TO 9
GO TO 8 IF(INF (I) .LT.0) GO TO 1
3
BLINK (I)=FLC
FLC=1
KON TC KON TC+1
IF (KONTC.LE. 10) NREENT (I)=M2
GO TO 2
INP (I)=IAND (INF (I), M2)
1 2
I=1-4 IP (I.GE.0) GO TO 3 IF (KONTC.GT.10) GOTO 21
8
21
KGBC=1 CONTINUE
RETURN
END
