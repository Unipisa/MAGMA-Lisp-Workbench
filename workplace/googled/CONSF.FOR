INTEGER FUNCTION CONSF (ARG1,ARG2) IMPLICIT INTEGER (A-Z)
COMMON/VALUE/VA (4), VALUE (1023) COMMON/ ECHOGC / ECHOGC
COMMON KWR/ KWR
COMMON /NIL/NIL/CAR/ADV (4), CAR (15767)/CDR/ADV1 (4),CDR (1576 COMMON/FLFS/FLFS
COMMON /KPREE/KFREE /BUFLAG/BUFLAG */GCFLAG/G CFLAG
INTEGER NIL, CAR,CDR, TEMP, ARG1,ARG2, FLFS
TEMP=PLFS
FLFS CAR (FLFS)
IF (CDR (TEMP) .EQ. BUFLAG) GOTO
3
1
67
CAR (TEMP) =ARG 1 CDR (TEMP) =ARG 2
CONSP TEMP
RETURN
IF(ECHOGC.EQ.0) GO TO 6
IF (KWR.EQ.0) WRITE (6,7) KWR = 1 FORMAT ( FREE STORAGE EXHAUSTED')
GCFLAG=3 IF (FLFS. EQ.NIL) GOTO 4
GOTO 3
45 5
WRITE (6,5)
FORMAT ( NO RECOVERY POSSIBLE STOP BY SYSTEM')
CALL HLT
RETURN END
1
